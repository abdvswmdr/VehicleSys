#+TITLE: VehicleSys
#+HTML: <a href="https://github.com/abdvswmdr/VehicleSys/releases"><img alt="Last release" src="https://img.shields.io/github/v/tag/abdvswmdr/VehicleSys?label=release"></a> &nbsp; <a href="https://github.com/abdvswmdr/VehicleSys/blob/main/LICENSE"><img alt="License: GPL v3" src="https://img.shields.io/badge/License-GPLv3-blue.svg"></a> &nbsp; <a href="https://github.com/abdvswmdr/VehicleSys/commits"><img alt="Commits since last release" src="https://img.shields.io/github/commits-since/abdvswmdr/VehicleSys/latest"></a> &nbsp; <a href="https://github.com/abdvswmdr/VehicleSys"><img alt="Last commit" src="https://img.shields.io/github/last-commit/abdvswmdr/VehicleSys"></a><br>

#+TITLE: VehicleSys

VehicleSys is an interactive car infotainment system that demonstrates Qt/QML development features. The application has a clean, intuitive interface with real-time vehicle data management, interactive controls, and modern automotive UI design principles.

#+attr_html: :width 1030 :height 826 :align center :alt VehicleSys in Action
[[file:vehiclesys.gif]]

** Contents
 * [[#installation][Installation]]
 * [[#configuration][Configuration]]
 * [[#features][Features]]
 * [[#troubleshooting][Troubleshooting]]

** Installation

*** Prerequisites


** Technical Stack

- Linux Ubuntu 24.04
- [Qt 5.15][https://www.qt.io/blog/qt-5.15-released]>
- CMake 3.20+
- C++17 (backend) / QML (frontend)
- CAN Bus: SocketCAN interface (vcan0)
- Navigation: MapboxGL with QtLocation
- PulseAudio/PipeWire 
- Qt Multimedia with GStreamer backend

*** Manual Installation
#+begin_src bash
  sudo apt-get update
  sudo apt-get install qt5-default qtdeclarative5-dev qtpositioning5-dev qtlocation5-dev \
       qtmultimedia5-dev libqt5multimedia5-plugins libqt5multimedia5 \
       cmake build-essential

  # For audio codec support, you may also need:
  sudo apt-get install gstreamer1.0-plugins-bad gstreamer1.0-plugins-ugly

  # Clone the repository
  git clone https://github.com/abdvswmdr/VehicleSys 
  cd Vehicle-Infotainment

  mkdir build && cd build # Build the project
  cmake ..
  make

  ./VehicleSys # Run the application

  # Add music in directory
  # (supported formats: MP3, MP4, WAV, OGG, M4A, AAC, FLAC, WMA)
  mkdir music 
  cp </path/to/your/music/>.mp3 music/
  #+end_src

** Architecture

*** C4 Model Diagrams

The system architecture is documented using the C4 model with professional PlantUML diagrams. Source: [[file:c4-diagrams.puml][c4-diagrams.puml]]
#+attr_html: :width 1030 :height 826 :align center :alt VehicleSys in Action

**** Level 1: System Context
The driver uses VehicleSys to view and control the vehicle. The application reads vehicle data from the CAN bus (vcan0) and renders maps using MapboxGL.
[[file:c1-system-context.png]]

**** Level 2: Container
A single Qt/QML desktop application integrating all functionality: dashboard telemetry, climate control, media playback, and navigation. The DBC file defines CAN message schemas.
[[file:c2-container.png]]

**** Level 3: Component
The QML UI binds to C++ controllers for system state, vehicle telemetry, HVAC control, and media playback. The CAN Bus Controller handles communication with vehicle hardware via vcan0.
[file:c3-component.png]]

** Configuration

If you encounter audio issues ("Qt Multimedia not available"):
#+begin_src bash
sudo apt-get install qtmultimedia5-dev libqt5multimedia5-plugins libqt5multimedia5 \
                     gstreamer1.0-plugins-bad gstreamer1.0-plugins-ugly

# Rebuild
rm -rf build && mkdir build && cd build
cmake .. && make -j4
#+end_src

*** Music System Architecture

- =MediaController=: Handles audio playback, playlist management, and media controls
- =AudioController=: Manages volume levels and audio routing
- =MusicPlayerStatus=: Real-time display component showing current track info
- =Integration=: Seamless volume synchronization between UI and audio backend

When Qt Multimedia is properly configured, you should see:
#+begin_src bash
MediaController: Qt Multimedia available, audio role set to MusicRole
MediaController: Initial volume set to: 50
Found <X> audio files in "/path/to/audio"
Loaded <X> tracks
#+end_src

Instead of the fallback message:
```
MediaController: Qt Multimedia not available - audio playback will not work
Loaded 19 tracks (simulation mode)
```

**ðŸ”§ Troubleshooting

#**Common QML Errors and Solutions

##**1. "StatusBar is not a type" Error
=Problem=: QML component not registered in qmldir
```
qrc:/ui/RightScreen/RightScreen.qml:24:5: StatusBar is not a type
```

=Solution=: Ensure `ui/RightScreen/qmldir` contains:
```
StatusBar 1.0 StatusBar.qml
```

#### 2. "Cannot anchor item to self" Error
=Problem=: Circular anchor reference in QML
```
qrc:/ui/BottomBar/BottomBar.qml:155:3: QML VolumeControlComponent: Cannot anchor item to self.
```

=Solution=: Remove self-referencing anchors:
```qml
// WRONG
anchors.left: volumeControl.left

// CORRECT  
width: 80
anchors.right: parent.right
```

#### 3. "ReferenceError: albumArt is not defined"
=Problem=: Missing id property on QML element
```
qrc:/ui/BottomBar/MusicPlayerStatus.qml:39: ReferenceError: albumArt is not defined
```

=Solution=: Add id to the referenced element:
```qml
Rectangle {
    id: albumArt  // Add this line
    width: parent.height
    // ... rest of properties
}
```

#### 4. "Unable to assign [undefined] to bool"
=Problem=: Property doesn't exist on controller object
```
qrc:/ui/Dashboard/VehicleDashboard.qml:335:3: Unable to assign [undefined] to bool
```

=Solution=: Check property exists in C++ controller:
```qml
// WRONG (if highBeam property doesn't exist)
active: vehicleData.highBeam

// CORRECT (use existing property)
active: vehicleData.headlights
```

### Audio System Issues

#### 1. No Audio Output
=Check audio system status=:
```bash
pactl info
pactl list sinks short
pulseaudio --check  # Should return nothing if running
```

#### 2. GStreamer Plugin Issues
=Install additional codecs=:
```bash
sudo apt-get install gstreamer1.0-libav gstreamer1.0-plugins-ugly gstreamer1.0-plugins-bad
```

#### 3. Qt Multimedia Detection
=Verify Qt Multimedia is linked=:
```bash
ldd VehicleSys | grep Qt5Multimedia
```

Should show: `libQt5Multimedia.so.5 => /usr/lib/...`


** Features

- Dual-zone climate control (50-90Â°F)
- Full music player with Qt Multimedia integration
- Interactive dashboard with gauges and telltales
- MapboxGL navigation interface
- Real-time vehicle telemetry (speed, RPM, fuel, temperature)
- Lock/unlock functionality
- Connectivity indicators (Bluetooth, Wi-Fi, Battery)
- Responsive automotive-inspired UI design

** Contributing

This is a personal learning project showcasing C++ and Qt/QML development. Feedback and suggestions for improvements are welcome!

** License

This project is open source and available under the [[file:LICENSE][GPL v3 License]].

